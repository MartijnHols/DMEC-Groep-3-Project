Scrollator={scrollatorElementsStack:[],refreshAll:function(){var e=Scrollator.scrollatorElementsStack.length;while(e--){if(!Scrollator.scrollatorElementsStack[e].$sourceElement.closest("body").length>0){Scrollator.scrollatorElementsStack[e].destroy()}else{Scrollator.scrollatorElementsStack[e].refresh()}}}};$(window).load(function(){Scrollator.refreshAll()});(function(e){e.scrollator=function(t,n){var r={custom_class:"",zIndex:""};var i=this;i.settings={};var s=e(t);i.$sourceElement=s;var o=null;var u=null;var a=null;var f=null;var l=null;var c=null;var h=false;var p=0;var d=0;var v=0;i.init=function(){i.settings=e.extend({},r,n);o=e("#scrollator_holder");s.addClass("scrollator");u=e(document.createElement("div")).addClass("scrollator_lane_holder");u.addClass(i.settings.custom_class);u.css("z-index",s.css("z-index"));i.settings.zIndex!==""&&u.css("z-index",i.settings.zIndex);s.is("body")&&u.addClass("scrollator_on_body");a=e(document.createElement("div")).addClass("scrollator_lane");f=e(document.createElement("div")).addClass("scrollator_handle_holder");l=e(document.createElement("div")).addClass("scrollator_handle");x();s.bind("mousewheel DOMMouseScroll",m);u.bind("mousewheel DOMMouseScroll",m);a.bind("mousewheel DOMMouseScroll",m);f.bind("mousewheel DOMMouseScroll",m);l.bind("mousewheel DOMMouseScroll",m);s.bind("mousemove",g);u.bind("mousemove",g);a.bind("mousemove",g);f.bind("mousemove",g);l.bind("mousemove",g);f.bind("mousedown",y);l.bind("mousedown",y);f.append(l);a.append(f);u.append(a);o.append(u);e(window).bind("mouseup",w);e(window).bind("mousemove",b);e(window).bind("keydown",E);S();if(!document.body.hasScrollatorPageResizeEventHandler){document.body.hasScrollatorPageResizeEventHandler=true;e(window).bind("resize",function(){Scrollator.refreshAll()})}g()};var m=function(t){if(!t.ctrlKey){if(e(t.target).css("overflow-y")!="auto"){t.preventDefault();t.stopPropagation();var n=(s.is("body")?e(window):s).scrollTop();var r=0;if(t.originalEvent.wheelDeltaY!==undefined&&t.originalEvent.wheelDeltaY!==0){r=t.originalEvent.wheelDeltaY/1.2}else if(t.originalEvent.wheelDelta!==undefined&&t.originalEvent.wheelDelta!==0){r=t.originalEvent.wheelDelta/1.2}else if(t.originalEvent.detail!==undefined&&t.originalEvent.detail!==0){r=t.originalEvent.detail*-33.33}n+=r*-1;(s.is("body")?e(window):s).scrollTop(n);Scrollator.refreshAll()}}};var g=function(){clearTimeout(c);if(s[0].scrollHeight>(s.is("body")?e(window).height():s.innerHeight())){u.css("opacity",1);c=setTimeout(function(){u.css("opacity",0)},1500)}else{u.css("opacity",0)}};var y=function(t){t.preventDefault();h=true;p=t.clientY;d=(s.is("body")?e(window):s).scrollTop();v=t.offsetY;u.addClass("hover")};var b=function(t){if(h){var n=t.clientY-p;var r=s[0].scrollHeight/(s.is("body")?e(window).height():s.innerHeight());(s.is("body")?e(window):s).scrollTop(d+n*r);Scrollator.refreshAll();g()}};var w=function(){h=false;u.removeClass("hover")};var E=function(t){var n={pageUp:33,pageDown:34};if((t.keyCode==n.pageUp||t.keyCode==n.pageDown)&&e(document.activeElement).prop("tagName")!="TEXTAREA"){var r=(s.is("body")?e(window):s).scrollTop();var i=(s.is("body")?e(window).height():s.innerHeight())*.9;if(t.keyCode==n.pageUp){r-=i}else if(t.keyCode==n.pageDown){r+=i}(s.is("body")?e(window):s).scrollTop(r);Scrollator.refreshAll();g()}};i.refresh=function(){S()};var S=function(){var t=s[0].getBoundingClientRect();var n={left:t.left+e(window).scrollLeft(),top:t.top+e(window).scrollTop(),right:t.right+e(window).scrollLeft(),bottom:t.bottom+e(window).scrollTop(),width:t.width,height:t.height};var r=parseInt(s.css("border-top-width"),10);var i=parseInt(s.css("border-right-width"),10);var o=parseInt(s.css("border-bottom-width"),10);var a=parseInt(s.css("border-left-width"),10);var l=s[0].scrollHeight;var c=s.is("body")?e(window).height():s.innerHeight();var h=c/l*100;var p=(s.is("body")?e(window):s).scrollTop()/l*100;if(!s.is("body")){u.css({top:n.top+r,right:-n.right+i,bottom:-n.bottom+o})}f.css({height:h+"%",top:p+"%"})};var x=function(){if(o.length===0){o=e(document.createElement("div")).attr("id","scrollator_holder");e("body").append(o)}};i.hide=function(){u.hide()};i.show=function(){u.show()};i.destroy=function(){s.removeClass("scrollator");e.removeData(t,"scrollator");s.unbind("mousewheel DOMMouseScroll",m);s.unbind("mousemove",g);e(window).unbind("mouseup",w);e(window).unbind("mousemove",b);e(window).unbind("keydown",E);u.remove();var n=Scrollator.scrollatorElementsStack.length;while(n--){if(Scrollator.scrollatorElementsStack[n]===i){Scrollator.scrollatorElementsStack.splice(n,1)}}if(o.children().length===0){o.remove();o=null}};i.init()};e.fn.scrollator=function(t){t=t!==undefined?t:{};return this.each(function(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){if(typeof t==="object"){if(undefined===e(this).data("scrollator")){var n=new e.scrollator(this,t);Scrollator.scrollatorElementsStack.push(n);e(this).data("scrollator",n)}}else if(e(this).data("scrollator")[t]){e(this).data("scrollator")[t].apply(this,Array.prototype.slice.call(arguments,1))}else{e.error("Method "+t+" does not exist in $.scrollator")}}})}})(jQuery)